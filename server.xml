<server description="Loyalty Level server">
    <featureManager>
        <feature>microProfile-1.2</feature>
        <feature>jndi-1.0</feature>
        <feature>jca-1.7</feature>
        <feature>jms-2.0</feature>
        <feature>appSecurity-2.0</feature>
    </featureManager>

    <httpEndpoint httpPort="9080" httpsPort="9443" host="*" id="defaultHttpEndpoint"/>

    <keyStore id="defaultKeyStore" password="passw0rd"/>

    <authData id="MQ-Credentials" user="${env.MQ_ID}" password="${env.MQ_PASSWORD}"></authData>

    <resourceAdapter id="mq" location="/config/wmq.jmsra.rar"/>

    <jmsQueueConnectionFactory id="NotificationQCF" jndiName="jms/Portfolio/NotificationQueueConnectionFactory" containerAuthDataRef="MQ-Credentials">
        <properties.mq 
            transportType="CLIENT"
            hostName="${env.MQ_HOST}" 
            port="${env.MQ_PORT}"
            channel="${env.MQ_CHANNEL}"
            queueManager="${env.MQ_QUEUE_MANAGER}"/>
    </jmsQueueConnectionFactory>
    <jmsQueue id="NotificationQ" jndiName="jms/Portfolio/NotificationQueue">
        <properties.mq baseQueueName="${env.MQ_QUEUE}" baseQueueManagerName="${env.MQ_QUEUE_MANAGER}"/>
    </jmsQueue>

<!-- Use this to be a client to Liberty's built-in JMS provider (running in a messaging-engine pod) instead of MQ
    <jmsQueueConnectionFactory id="NotificationQCF" jndiName="jms/Portfolio/NotificationQueueConnectionFactory">
        <properties.wasJms remoteServerAddress="messaging-engine-service:7276:BootstrapBasicMessaging"/>
    </jmsQueueConnectionFactory>
    <jmsQueue id="NotificationQ" jndiName="jms/Portfolio/NotificationQueue">
        <properties.wasJms queueName="NotificationQ"/>
    </jmsQueue>
-->

    <basicRegistry id="basic" realm="BasicRegistry">
    	<user name="admin" password="admin"/>
    	<user name="stock" password="trader"/>
    	<user name="read" password="only"/>
    	<user name="other" password="other"/> <!-- ID with no access to Stock Trader -->
    	<group name="StockTrader">
    		<member name="stock"/>
    		<member name="admin"/>
    	</group>
    	<group name="StockViewer">
    		<member name="read"/>
    	</group>
    </basicRegistry>

    <administrator-role>
    	<user>admin</user>
    </administrator-role>

    <webApplication id="LoyaltyLevel" location="LoyaltyLevel.war" name="LoyaltyLevel" contextRoot="/loyalty-level"/>
</server>
